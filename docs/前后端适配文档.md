# å‰åç«¯é€‚é…æ–‡æ¡£

## é¡¹ç›®æ¦‚è¿°

æœ¬æ–‡æ¡£åŸºäºç°æœ‰å‰ç«¯Vue 3é¡¹ç›®ï¼Œåˆ†æåç«¯Spring Boot + MyBatisé¡¹ç›®çš„APIæ¥å£ï¼Œå¹¶æä¾›é€‚é…æ–¹æ¡ˆã€‚

**å‰ç«¯æŠ€æœ¯æ ˆ**: Vue 3 + Vue Router + Tailwind CSS + Pinia  
**åç«¯æŠ€æœ¯æ ˆ**: Spring Boot + MyBatis + MySQL  
**åç«¯åœ°å€**: http://localhost:8080/api

---

## ä¸€ã€APIæ¥å£æ˜ å°„

### 1.1 é¦–é¡µ (Home.vue)

| å‰ç«¯éœ€æ±‚ | åç«¯API | è¯´æ˜ |
|---------|---------|------|
| è·å–ä¹¦ç±åˆ†ç±» | `GET /books/categories` | è¿”å›åˆ†ç±»åˆ—è¡¨ï¼ˆid, name, icon, descriptionï¼‰ |
| è·å–çƒ­é—¨ä¹¦ç± | `GET /books/hot?limit=4` | è¿”å›çƒ­é—¨ä¹¦ç±åˆ—è¡¨ |
| å¹³å°ç»Ÿè®¡æ•°æ® | æš‚æ— æ¥å£ | å‰ç«¯ä½¿ç”¨é™æ€æ•°æ®å±•ç¤º |

**å“åº”ç¤ºä¾‹**:
```json
// GET /books/categories
{
  "code": 200,
  "message": "success",
  "data": [
    {
      "id": "textbook",
      "name": "æ•™ææ•™è¾…",
      "icon": "ğŸ“š",
      "description": "å„ç±»æ•™æå’Œæ•™è¾…ä¹¦ç±"
    }
  ]
}

// GET /books/hot?limit=4
{
  "code": 200,
  "message": "success",
  "data": [
    {
      "id": 1,
      "title": "é«˜ç­‰æ•°å­¦",
      "cover": "http://...",
      "price": 35.00,
      "originalPrice": 68.00,
      "category": "æ•™ææ•™è¾…"
    }
  ]
}
```

---

### 1.2 ä¹¦ç±åˆ—è¡¨é¡µ (Books.vue)

| å‰ç«¯éœ€æ±‚ | åç«¯API | è¯´æ˜ |
|---------|---------|------|
| è·å–ä¹¦ç±åˆ—è¡¨ | `GET /books` | æ”¯æŒåˆ†é¡µã€ç­›é€‰ã€æ’åº |
| æœç´¢ä¹¦ç± | `GET /books?keyword=xxx` | æœç´¢ä¹¦åã€ä½œè€…ã€ISBN |
| æŒ‰åˆ†ç±»ç­›é€‰ | `GET /books?category=xxx` | æŒ‰åˆ†ç±»IDç­›é€‰ |
| æŒ‰æˆè‰²ç­›é€‰ | `GET /books?condition=xxx` | æŒ‰æ–°æ—§ç¨‹åº¦ç­›é€‰ |
| ä»·æ ¼èŒƒå›´ç­›é€‰ | `GET /books?priceMin=xx&priceMax=xx` | ä»·æ ¼åŒºé—´ç­›é€‰ |
| æ’åº | `GET /books?sortBy=xxx` | æ”¯æŒä»·æ ¼ã€æ—¶é—´æ’åº |

**è¯·æ±‚å‚æ•°**:
```typescript
{
  page: number,           // é¡µç ï¼Œé»˜è®¤1
  pageSize: number,       // æ¯é¡µæ•°é‡ï¼Œé»˜è®¤12
  category?: string,      // åˆ†ç±»ID
  priceMin?: number,      // æœ€ä½ä»·æ ¼
  priceMax?: number,      // æœ€é«˜ä»·æ ¼
  condition?: string,    // æˆè‰²ï¼ˆå…¨æ–°ã€ä¹æˆæ–°ã€å…«æˆæ–°ã€ä¸ƒæˆæ–°ï¼‰
  keyword?: string,       // æœç´¢å…³é”®è¯
  sortBy?: string         // æ’åºæ–¹å¼ï¼ˆprice_asc, price_desc, time_descï¼‰
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "title": "é«˜ç­‰æ•°å­¦ï¼ˆç¬¬ä¸ƒç‰ˆï¼‰ä¸Šå†Œ",
        "author": "åŒæµå¤§å­¦æ•°å­¦ç³»",
        "price": 35.00,
        "originalPrice": 68.00,
        "condition": "ä¹æˆæ–°",
        "category": "æ•™ææ•™è¾…",
        "cover": "http://...",
        "createdAt": "2024-01-15 14:30:00"
      }
    ],
    "total": 100,
    "page": 1,
    "pageSize": 12
  }
}
```

---

### 1.3 ä¹¦ç±è¯¦æƒ…é¡µ (BookDetail.vue)

| å‰ç«¯éœ€æ±‚ | åç«¯API | è¯´æ˜ |
|---------|---------|------|
| è·å–ä¹¦ç±è¯¦æƒ… | `GET /books/{id}` | è¿”å›ä¹¦ç±å®Œæ•´ä¿¡æ¯ |
| è·å–å–å®¶ä¿¡æ¯ | `GET /books/{id}/seller` | è¿”å›å–å®¶è¯¦ç»†ä¿¡æ¯ |
| è·å–ä¹¦ç±è¯„ä»· | `GET /books/{id}/reviews` | åˆ†é¡µè·å–è¯„ä»·åˆ—è¡¨ |
| è·å–è¯„ä»·ç»Ÿè®¡ | `GET /books/{id}/reviews/statistics` | è¯„åˆ†ç»Ÿè®¡ä¿¡æ¯ |
| è·å–ç›¸ä¼¼æ¨è | `GET /books/{id}/related` | åŒåˆ†ç±»æ¨èä¹¦ç± |
| æ·»åŠ æ”¶è— | æš‚æ— æ¥å£ | éœ€è¦æ–°å¢æ¥å£ |
| å–æ¶ˆæ”¶è— | æš‚æ— æ¥å£ | éœ€è¦æ–°å¢æ¥å£ |
| ç«‹å³è´­ä¹° | æš‚æ— æ¥å£ | éœ€è¦æ–°å¢è®¢å•æ¥å£ |

**ä¹¦ç±è¯¦æƒ…å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1,
    "title": "é«˜ç­‰æ•°å­¦ï¼ˆç¬¬ä¸ƒç‰ˆï¼‰ä¸Šå†Œ",
    "author": "åŒæµå¤§å­¦æ•°å­¦ç³»",
    "publisher": "é«˜ç­‰æ•™è‚²å‡ºç‰ˆç¤¾",
    "isbn": "9787040396638",
    "publishDate": "2014-07",
    "pages": 368,
    "price": 35.00,
    "originalPrice": 68.00,
    "condition": "ä¹æˆæ–°",
    "category": "æ•™ææ•™è¾…",
    "cover": "http://...",
    "images": [],
    "description": "ä¹¦ç±æè¿°...",
    "sellerId": 100,
    "status": 1,
    "createdAt": "2024-01-15 14:30:00"
  }
}
```

**å–å®¶ä¿¡æ¯å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 100,
    "username": "å¼ åŒå­¦",
    "avatar": "http://...",
    "sellerLevel": "é‡‘ç‰Œå–å®¶",
    "sellerIsVerified": 1,
    "sellerDescription": "è¯šä¿¡ç»è¥ï¼Œæ¬¢è¿é€‰è´­",
    "sellerPositiverate": 98.5,
    "sellerRating": 4.9,
    "sellerSalesCount": 23
  }
}
```

**è¯„ä»·åˆ—è¡¨å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "bookId": 1,
        "userId": 101,
        "userName": "æåŒå­¦",
        "userAvatar": "http://...",
        "rating": 5,
        "content": "ä¹¦ç±æˆè‰²å¾ˆå¥½ï¼Œå–å®¶å¾ˆè¯šä¿¡",
        "createdAt": "2024-01-10 10:00:00"
      }
    ],
    "total": 10,
    "page": 1,
    "pageSize": 10
  }
}
```

**è¯„ä»·ç»Ÿè®¡å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "averageRating": 4.8,
    "totalCount": 10,
    "ratingCounts": {
      "5": 8,
      "4": 1,
      "3": 1,
      "2": 0,
      "1": 0
    }
  }
}
```

---

### 1.4 å‘å¸ƒä¹¦ç±é¡µ (Publish.vue)

| å‰ç«¯éœ€æ±‚ | åç«¯API | è¯´æ˜ |
|---------|---------|------|
| å‘å¸ƒä¹¦ç± | æš‚æ— æ¥å£ | éœ€è¦æ–°å¢POSTæ¥å£ |
| ä¸Šä¼ å›¾ç‰‡ | æš‚æ— æ¥å£ | éœ€è¦æ–°å¢æ–‡ä»¶ä¸Šä¼ æ¥å£ |

**éœ€è¦æ–°å¢çš„æ¥å£**:
```
POST /books
Content-Type: multipart/form-data

{
  title: string,           // ä¹¦åï¼ˆå¿…å¡«ï¼‰
  author: string,          // ä½œè€…ï¼ˆå¿…å¡«ï¼‰
  publisher: string,      // å‡ºç‰ˆç¤¾
  isbn: string,            // ISBN
  categoryId: string,      // åˆ†ç±»IDï¼ˆå¿…å¡«ï¼‰
  condition: string,       // æˆè‰²ï¼ˆå¿…å¡«ï¼‰
  price: number,           // å”®ä»·ï¼ˆå¿…å¡«ï¼‰
  originalPrice: number,   // åŸä»·
  description: string,    // æè¿°
  cover: File,             // å°é¢å›¾ç‰‡ï¼ˆå¿…å¡«ï¼‰
  images: File[],          // é™„åŠ å›¾ç‰‡æ•°ç»„
  sellerId: number         // å–å®¶IDï¼ˆä»tokenè·å–ï¼‰
}
```

---

### 1.5 ä¸ªäººä¸­å¿ƒ (Profile.vue)

| å‰ç«¯éœ€æ±‚ | åç«¯API | è¯´æ˜ |
|---------|---------|------|
| è·å–ç”¨æˆ·ä¿¡æ¯ | æš‚æ— æ¥å£ | éœ€è¦æ–°å¢GETæ¥å£ |
| æ›´æ–°ç”¨æˆ·ä¿¡æ¯ | æš‚æ— æ¥å£ | éœ€è¦æ–°å¢PUTæ¥å£ |
| è·å–æˆ‘çš„ä¹¦ç± | æš‚æ— æ¥å£ | éœ€è¦æ–°å¢æ¥å£ |
| è·å–æˆ‘çš„è®¢å• | æš‚æ— æ¥å£ | éœ€è¦æ–°å¢æ¥å£ |
| è·å–æˆ‘çš„æ”¶è— | æš‚æ— æ¥å£ | éœ€è¦æ–°å¢æ¥å£ |
| æ·»åŠ æ”¶è— | æš‚æ— æ¥å£ | éœ€è¦æ–°å¢æ¥å£ |
| å–æ¶ˆæ”¶è— | æš‚æ— æ¥å£ | éœ€è¦æ–°å¢æ¥å£ |

**éœ€è¦æ–°å¢çš„æ¥å£**:
```
GET /users/profile
GET /users/books
GET /users/orders
GET /users/favorites
POST /users/favorites
DELETE /users/favorites/{bookId}
PUT /users/profile
```

---

### 1.6 è®¤è¯ç›¸å…³ (Navbar.vue)

| å‰ç«¯éœ€æ±‚ | åç«¯API | è¯´æ˜ |
|---------|---------|------|
| ç”¨æˆ·ç™»å½• | `POST /auth/login` | è¿”å›JWT token |
| ç”¨æˆ·æ³¨å†Œ | `POST /auth/register` | æ³¨å†Œæ–°ç”¨æˆ· |
| é€€å‡ºç™»å½• | å‰ç«¯æ¸…é™¤token | æ— éœ€åç«¯æ¥å£ |

**ç™»å½•è¯·æ±‚ç¤ºä¾‹**:
```json
{
  "username": "test",
  "password": "123456"
}
```

**ç™»å½•å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiJ9...",
    "user": {
      "id": 1,
      "username": "test",
      "avatar": "http://..."
    }
  }
}
```

**æ³¨å†Œè¯·æ±‚ç¤ºä¾‹**:
```json
{
  "username": "test",
  "phone": "13800138000",
  "password": "123456",
  "email": "test@example.com"
}
```

---

## äºŒã€æ•°æ®åº“è¡¨ä¸å‰ç«¯æ•°æ®æ˜ å°„

### 2.1 book è¡¨ï¼ˆä¹¦ç±è¡¨ï¼‰

| å­—æ®µ | ç±»å‹ | å‰ç«¯ä½¿ç”¨ | è¯´æ˜ |
|-----|------|---------|------|
| id | bigint | âœ… | ä¹¦ç±ID |
| title | varchar(255) | âœ… | ä¹¦å |
| author | varchar(100) | âœ… | ä½œè€… |
| isbn | varchar(20) | âœ… | ISBN |
| publisher | varchar(100) | âœ… | å‡ºç‰ˆç¤¾ |
| publishDate | varchar(20) | âœ… | å‡ºç‰ˆæ—¶é—´ |
| pages | int | âœ… | é¡µæ•° |
| categoryId | varchar(50) | âœ… | åˆ†ç±»IDï¼ˆéœ€å…³è”categoryè¡¨è·å–åç§°ï¼‰ |
| condition | varchar(20) | âœ… | æ–°æ—§ç¨‹åº¦ï¼ˆå…¨æ–°ã€ä¹æˆæ–°ã€å…«æˆæ–°ã€ä¸ƒæˆæ–°ï¼‰ |
| price | decimal(10,2) | âœ… | å”®ä»· |
| originalPrice | decimal(10,2) | âœ… | åŸä»· |
| stock | int | âš ï¸ | åº“å­˜ï¼ˆå‰ç«¯æœªä½¿ç”¨ï¼‰ |
| cover | varchar(500) | âœ… | å°é¢URL |
| images | json | âš ï¸ | å›¾ç‰‡æ•°ç»„ï¼ˆå‰ç«¯æœªä½¿ç”¨ï¼‰ |
| description | text | âœ… | æè¿° |
| sellerId | bigint | âœ… | å–å®¶ID |
| status | tinyint | âš ï¸ | çŠ¶æ€ï¼ˆå‰ç«¯æœªä½¿ç”¨ï¼‰ |
| createdAt | datetime | âœ… | åˆ›å»ºæ—¶é—´ï¼ˆç”¨äºæ’åºï¼‰ |
| updatedAt | datetime | âš ï¸ | æ›´æ–°æ—¶é—´ï¼ˆå‰ç«¯æœªä½¿ç”¨ï¼‰ |

---

### 2.2 category è¡¨ï¼ˆåˆ†ç±»è¡¨ï¼‰

| å­—æ®µ | ç±»å‹ | å‰ç«¯ä½¿ç”¨ | è¯´æ˜ |
|-----|------|---------|------|
| id | varchar(50) | âœ… | åˆ†ç±»IDï¼ˆè‹±æ–‡æ ‡è¯†ï¼‰ |
| name | varchar(50) | âœ… | åˆ†ç±»åç§° |
| icon | varchar(10) | âœ… | åˆ†ç±»å›¾æ ‡ï¼ˆemojiï¼‰ |
| description | varchar(200) | âœ… | åˆ†ç±»æè¿° |
| createdAt | datetime | âš ï¸ | åˆ›å»ºæ—¶é—´ï¼ˆå‰ç«¯æœªä½¿ç”¨ï¼‰ |
| updatedAt | datetime | âš ï¸ | æ›´æ–°æ—¶é—´ï¼ˆå‰ç«¯æœªä½¿ç”¨ï¼‰ |

**å‰ç«¯åˆ†ç±»æ˜ å°„**:
```javascript
const categories = [
  { id: 'textbook', name: 'æ•™ææ•™è¾…', icon: 'ğŸ“š' },
  { id: 'literature', name: 'æ–‡å­¦å°è¯´', icon: 'ğŸ“–' },
  { id: 'computer', name: 'è®¡ç®—æœº', icon: 'ğŸ’»' },
  { id: 'business', name: 'ç»ç®¡', icon: 'ğŸ“Š' },
  { id: 'language', name: 'å¤–è¯­', icon: 'ğŸŒ' },
  { id: 'other', name: 'å…¶ä»–', icon: 'ğŸ“¦' }
]
```

---

### 2.3 user è¡¨ï¼ˆç”¨æˆ·è¡¨ï¼‰

| å­—æ®µ | ç±»å‹ | å‰ç«¯ä½¿ç”¨ | è¯´æ˜ |
|-----|------|---------|------|
| id | bigint | âœ… | ç”¨æˆ·ID |
| username | varchar(50) | âœ… | ç”¨æˆ·å |
| phone | varchar(20) | âœ… | æ‰‹æœºå· |
| email | varchar(100) | âœ… | é‚®ç®± |
| password | varchar(255) | âœ… | å¯†ç ï¼ˆåŠ å¯†ï¼‰ |
| avatar | varchar(500) | âœ… | å¤´åƒURL |
| level | varchar(20) | âš ï¸ | ä¼šå‘˜ç­‰çº§ï¼ˆå‰ç«¯æœªä½¿ç”¨ï¼‰ |
| points | int | âš ï¸ | ç§¯åˆ†ï¼ˆå‰ç«¯æœªä½¿ç”¨ï¼‰ |
| isSeller | tinyint(1) | âš ï¸ | æ˜¯å¦å–å®¶ï¼ˆå‰ç«¯æœªä½¿ç”¨ï¼‰ |
| createdAt | datetime | âš ï¸ | åˆ›å»ºæ—¶é—´ï¼ˆå‰ç«¯æœªä½¿ç”¨ï¼‰ |
| updatedAt | datetime | âš ï¸ | æ›´æ–°æ—¶é—´ï¼ˆå‰ç«¯æœªä½¿ç”¨ï¼‰ |

**å‰ç«¯éœ€è¦çš„é¢å¤–å­—æ®µ**ï¼ˆéœ€è¦æ–°å¢ï¼‰:
- `school` - å­¦æ ¡
- `major` - ä¸“ä¸š
- `wechat` - å¾®ä¿¡å·

---

### 2.4 seller è¡¨ï¼ˆå–å®¶ä¿¡æ¯è¡¨ï¼Œç»§æ‰¿è‡ªuserï¼‰

| å­—æ®µ | ç±»å‹ | å‰ç«¯ä½¿ç”¨ | è¯´æ˜ |
|-----|------|---------|------|
| sellerLevel | varchar(20) | âœ… | å–å®¶ç­‰çº§ |
| sellerIsVerified | tinyint(1) | âœ… | æ˜¯å¦è®¤è¯ |
| sellerDescription | varchar(255) | âœ… | å–å®¶æè¿° |
| sellerPositiverate | decimal(5,1) | âœ… | å¥½è¯„ç‡ |
| sellerRating | decimal(3,1) | âœ… | å–å®¶è¯„åˆ† |
| sellerSalesCount | int | âœ… | é”€å”®æ•°é‡ |

---

### 2.5 review è¡¨ï¼ˆè¯„ä»·è¡¨ï¼‰

| å­—æ®µ | ç±»å‹ | å‰ç«¯ä½¿ç”¨ | è¯´æ˜ |
|-----|------|---------|------|
| id | bigint | âœ… | è¯„ä»·ID |
| bookId | bigint | âœ… | ä¹¦ç±ID |
| userId | bigint | âœ… | è¯„ä»·ç”¨æˆ·ID |
| userName | varchar(50) | âœ… | è¯„ä»·ç”¨æˆ·åç§° |
| userAvatar | varchar(500) | âœ… | è¯„ä»·ç”¨æˆ·å¤´åƒ |
| rating | tinyint | âœ… | è¯„åˆ†ï¼ˆ1-5ï¼‰ |
| content | text | âœ… | è¯„ä»·å†…å®¹ |
| createdAt | datetime | âœ… | åˆ›å»ºæ—¶é—´ |

---

### 2.6 cart è¡¨ï¼ˆè´­ç‰©è½¦è¡¨ï¼‰

| å­—æ®µ | ç±»å‹ | å‰ç«¯ä½¿ç”¨ | è¯´æ˜ |
|-----|------|---------|------|
| id | bigint | âœ… | è´­ç‰©è½¦ID |
| userId | bigint | âœ… | ç”¨æˆ·ID |
| bookId | bigint | âœ… | ä¹¦ç±ID |
| quantity | int | âš ï¸ | æ•°é‡ï¼ˆå‰ç«¯æœªä½¿ç”¨è´­ç‰©è½¦åŠŸèƒ½ï¼‰ |
| price | decimal(10,2) | âš ï¸ | æ·»åŠ æ—¶çš„ä»·æ ¼ï¼ˆå‰ç«¯æœªä½¿ç”¨ï¼‰ |
| createdAt | datetime | âš ï¸ | åˆ›å»ºæ—¶é—´ï¼ˆå‰ç«¯æœªä½¿ç”¨ï¼‰ |

---

### 2.7 favorite è¡¨ï¼ˆæ”¶è—è¡¨ï¼‰

| å­—æ®µ | ç±»å‹ | å‰ç«¯ä½¿ç”¨ | è¯´æ˜ |
|-----|------|---------|------|
| id | bigint | âœ… | æ”¶è—ID |
| userId | bigint | âœ… | ç”¨æˆ·ID |
| bookId | bigint | âœ… | ä¹¦ç±ID |
| createdAt | datetime | âš ï¸ | åˆ›å»ºæ—¶é—´ï¼ˆå‰ç«¯æœªä½¿ç”¨ï¼‰ |

---

### 2.8 order è¡¨ï¼ˆè®¢å•è¡¨ï¼‰

| å­—æ®µ | ç±»å‹ | å‰ç«¯ä½¿ç”¨ | è¯´æ˜ |
|-----|------|---------|------|
| id | bigint | âœ… | è®¢å•ID |
| orderNo | varchar(32) | âœ… | è®¢å•å· |
| buyerId | bigint | âœ… | ä¹°å®¶ID |
| sellerId | bigint | âœ… | å–å®¶ID |
| bookId | bigint | âœ… | ä¹¦ç±ID |
| quantity | int | âœ… | æ•°é‡ |
| price | decimal(10,2) | âœ… | å•ä»· |
| totalPrice | decimal(10,2) | âœ… | æ€»ä»· |
| status | varchar(20) | âœ… | è®¢å•çŠ¶æ€ |
| paymentStatus | varchar(20) | âœ… | æ”¯ä»˜çŠ¶æ€ |
| shippingStatus | varchar(20) | âœ… | ç‰©æµçŠ¶æ€ |
| createdAt | datetime | âœ… | åˆ›å»ºæ—¶é—´ |
| paidAt | datetime | âš ï¸ | æ”¯ä»˜æ—¶é—´ï¼ˆå‰ç«¯æœªä½¿ç”¨ï¼‰ |
| shippedAt | datetime | âš ï¸ | å‘è´§æ—¶é—´ï¼ˆå‰ç«¯æœªä½¿ç”¨ï¼‰ |
| receivedAt | datetime | âš ï¸ | æ”¶è´§æ—¶é—´ï¼ˆå‰ç«¯æœªä½¿ç”¨ï¼‰ |

---

## ä¸‰ã€éœ€è¦æ–°å¢çš„åç«¯æ¥å£

### 3.1 ä¹¦ç±ç›¸å…³

```java
// å‘å¸ƒä¹¦ç±
POST /books
Content-Type: multipart/form-data
Request Body: BookReq + cover file

// ä¸‹æ¶ä¹¦ç±
PUT /books/{id}/status
Request Body: { status: 0 }

// ä¸Šä¼ å›¾ç‰‡
POST /upload/image
Content-Type: multipart/form-data
Request Body: file
Response: { url: "http://..." }
```

### 3.2 ç”¨æˆ·ç›¸å…³

```java
// è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
GET /users/profile
Authorization: Bearer {token}

// æ›´æ–°ç”¨æˆ·ä¿¡æ¯
PUT /users/profile
Authorization: Bearer {token}
Request Body: { username, avatar, school, major, phone, wechat }

// è·å–æˆ‘çš„ä¹¦ç±
GET /users/books
Authorization: Bearer {token}
Query: page, pageSize, status

// è·å–æˆ‘çš„è®¢å•
GET /users/orders
Authorization: Bearer {token}
Query: page, pageSize, status

// è·å–æˆ‘çš„æ”¶è—
GET /users/favorites
Authorization: Bearer {token}
Query: page, pageSize

// æ·»åŠ æ”¶è—
POST /users/favorites
Authorization: Bearer {token}
Request Body: { bookId }

// å–æ¶ˆæ”¶è—
DELETE /users/favorites/{bookId}
Authorization: Bearer {token}
```

### 3.3 è®¢å•ç›¸å…³

```java
// åˆ›å»ºè®¢å•
POST /orders
Authorization: Bearer {token}
Request Body: { bookId, quantity }

// ç¡®è®¤æ”¶è´§
PUT /orders/{id}/confirm
Authorization: Bearer {token}

// å–æ¶ˆè®¢å•
PUT /orders/{id}/cancel
Authorization: Bearer {token}
```

---

## å››ã€å‰ç«¯éœ€è¦å®ç°çš„åŠŸèƒ½

### 4.1 APIè¯·æ±‚å°è£…

å»ºè®®åˆ›å»º `src/api` ç›®å½•ï¼Œå°è£…APIè¯·æ±‚ï¼š

```javascript
// src/api/request.js
import axios from 'axios'

const request = axios.create({
  baseURL: 'http://localhost:8080/api',
  timeout: 10000
})

request.interceptors.request.use(config => {
  const token = localStorage.getItem('token')
  if (token) {
    config.headers.Authorization = `Bearer ${token}`
  }
  return config
})

request.interceptors.response.use(
  response => response.data,
  error => {
    if (error.response?.status === 401) {
      localStorage.removeItem('token')
      window.location.href = '/login'
    }
    return Promise.reject(error)
  }
)

export default request
```

### 4.2 APIæ¨¡å—

```javascript
// src/api/book.js
import request from './request'

export const getBooks = (params) => request.get('/books', { params })
export const getBookDetail = (id) => request.get(`/books/${id}`)
export const getCategories = () => request.get('/books/categories')
export const getHotBooks = (limit = 4) => request.get('/books/hot', { params: { limit } })
export const getBookReviews = (id, params) => request.get(`/books/${id}/reviews`, { params })
export const getBookReviewsStatistics = (id) => request.get(`/books/${id}/reviews/statistics`)
export const getBookRelated = (id, limit = 4) => request.get(`/books/${id}/related`, { params: { limit } })

// src/api/auth.js
export const login = (data) => request.post('/auth/login', data)
export const register = (data) => request.post('/auth/register', data)

// src/api/user.js
export const getUserProfile = () => request.get('/users/profile')
export const updateUserProfile = (data) => request.put('/users/profile', data)
export const getMyBooks = (params) => request.get('/users/books', { params })
export const getMyOrders = (params) => request.get('/users/orders', { params })
export const getMyFavorites = (params) => request.get('/users/favorites', { params })
export const addFavorite = (bookId) => request.post('/users/favorites', { bookId })
export const removeFavorite = (bookId) => request.delete(`/users/favorites/${bookId}`)
```

### 4.3 çŠ¶æ€ç®¡ç†

ä½¿ç”¨Piniaç®¡ç†ç”¨æˆ·çŠ¶æ€ï¼š

```javascript
// src/stores/user.js
import { defineStore } from 'pinia'
import { login, register, getUserProfile } from '@/api/auth'

export const useUserStore = defineStore('user', {
  state: () => ({
    user: null,
    token: localStorage.getItem('token') || null
  }),
  actions: {
    async login(credentials) {
      const res = await login(credentials)
      this.token = res.data.token
      this.user = res.data.user
      localStorage.setItem('token', res.data.token)
    },
    async register(data) {
      const res = await register(data)
      this.token = res.data.token
      this.user = res.data.user
      localStorage.setItem('token', res.data.token)
    },
    async fetchProfile() {
      const res = await getUserProfile()
      this.user = res.data
    },
    logout() {
      this.user = null
      this.token = null
      localStorage.removeItem('token')
    }
  }
})
```

---

## äº”ã€æ•°æ®æ ¼å¼è½¬æ¢

### 5.1 æ—¶é—´æ ¼å¼

åç«¯è¿”å›çš„æ—¶é—´æ ¼å¼ï¼š`2024-01-15 14:30:00`  
å‰ç«¯éœ€è¦è½¬æ¢ä¸ºç›¸å¯¹æ—¶é—´ï¼š`2å°æ—¶å‰`ã€`1å¤©å‰`

```javascript
function formatRelativeTime(dateStr) {
  const date = new Date(dateStr)
  const now = new Date()
  const diff = now - date
  
  const minute = 60 * 1000
  const hour = 60 * minute
  const day = 24 * hour
  
  if (diff < minute) return 'åˆšåˆš'
  if (diff < hour) return `${Math.floor(diff / minute)}åˆ†é’Ÿå‰`
  if (diff < day) return `${Math.floor(diff / hour)}å°æ—¶å‰`
  if (diff < 7 * day) return `${Math.floor(diff / day)}å¤©å‰`
  return date.toLocaleDateString()
}
```

### 5.2 ä»·æ ¼æ ¼å¼

åç«¯è¿”å›ï¼š`35.00`  
å‰ç«¯æ˜¾ç¤ºï¼š`Â¥35.00`

```javascript
function formatPrice(price) {
  return `Â¥${Number(price).toFixed(2)}`
}
```

### 5.3 æˆè‰²æšä¸¾

åç«¯å­˜å‚¨ï¼š`å…¨æ–°`ã€`ä¹æˆæ–°`ã€`å…«æˆæ–°`ã€`ä¸ƒæˆæ–°`  
å‰ç«¯æ˜¾ç¤ºï¼šä¿æŒä¸€è‡´

---

## å…­ã€ç¼ºå¤±åŠŸèƒ½è¯´æ˜

### 6.1 åç«¯ç¼ºå¤±çš„æ¥å£

1. **ç”¨æˆ·ç®¡ç†æ¥å£**
   - è·å–/æ›´æ–°ç”¨æˆ·ä¿¡æ¯
   - è·å–æˆ‘çš„ä¹¦ç±
   - è·å–æˆ‘çš„è®¢å•
   - æ”¶è—ç®¡ç†

2. **ä¹¦ç±å‘å¸ƒæ¥å£**
   - POST /books
   - æ–‡ä»¶ä¸Šä¼ æ¥å£

3. **è®¢å•ç®¡ç†æ¥å£**
   - åˆ›å»ºè®¢å•
   - ç¡®è®¤æ”¶è´§
   - å–æ¶ˆè®¢å•

4. **æ”¶è—ç®¡ç†æ¥å£**
   - æ·»åŠ /å–æ¶ˆæ”¶è—ï¼ˆåœ¨ç”¨æˆ·ç®¡ç†ä¸­ï¼‰

### 6.2 å‰ç«¯æœªä½¿ç”¨çš„åŠŸèƒ½

1. **è´­ç‰©è½¦åŠŸèƒ½** - æ•°æ®åº“æœ‰cartè¡¨ï¼Œä½†å‰ç«¯æœªå®ç°
2. **åº“å­˜ç®¡ç†** - bookè¡¨æœ‰stockå­—æ®µï¼Œä½†å‰ç«¯æœªæ˜¾ç¤º
3. **ä¼šå‘˜ç­‰çº§å’Œç§¯åˆ†** - userè¡¨æœ‰ç›¸å…³å­—æ®µï¼Œä½†å‰ç«¯æœªä½¿ç”¨
4. **å¤šå›¾ç‰‡å±•ç¤º** - bookè¡¨æœ‰imageså­—æ®µï¼Œä½†å‰ç«¯åªä½¿ç”¨å°é¢

### 6.3 æ•°æ®åº“å­—æ®µæ‰©å±•å»ºè®®

ä¸ºæ»¡è¶³å‰ç«¯éœ€æ±‚ï¼Œå»ºè®®åœ¨userè¡¨æ–°å¢ä»¥ä¸‹å­—æ®µï¼š

```sql
ALTER TABLE user ADD COLUMN school VARCHAR(100) COMMENT 'å­¦æ ¡';
ALTER TABLE user ADD COLUMN major VARCHAR(100) COMMENT 'ä¸“ä¸š';
ALTER TABLE user ADD COLUMN wechat VARCHAR(50) COMMENT 'å¾®ä¿¡å·';
```

---

## ä¸ƒã€å¼€å‘ä¼˜å…ˆçº§å»ºè®®

### ç¬¬ä¸€é˜¶æ®µï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰

1. âœ… å®ç°ä¹¦ç±åˆ—è¡¨é¡µï¼ˆå·²æœ‰APIï¼‰
2. âœ… å®ç°ä¹¦ç±è¯¦æƒ…é¡µï¼ˆå·²æœ‰APIï¼‰
3. âœ… å®ç°é¦–é¡µï¼ˆå·²æœ‰APIï¼‰
4. âš ï¸ å®ç°ç™»å½•/æ³¨å†Œï¼ˆå·²æœ‰APIï¼Œéœ€å‰ç«¯å¯¹æ¥ï¼‰
5. âš ï¸ å®ç°ä¹¦ç±å‘å¸ƒï¼ˆéœ€æ–°å¢åç«¯æ¥å£ï¼‰

### ç¬¬äºŒé˜¶æ®µï¼ˆç”¨æˆ·åŠŸèƒ½ï¼‰

1. âš ï¸ å®ç°ä¸ªäººä¸­å¿ƒï¼ˆéœ€æ–°å¢åç«¯æ¥å£ï¼‰
2. âš ï¸ å®ç°æˆ‘çš„ä¹¦ç±ï¼ˆéœ€æ–°å¢åç«¯æ¥å£ï¼‰
3. âš ï¸ å®ç°æˆ‘çš„è®¢å•ï¼ˆéœ€æ–°å¢åç«¯æ¥å£ï¼‰
4. âš ï¸ å®ç°æˆ‘çš„æ”¶è—ï¼ˆéœ€æ–°å¢åç«¯æ¥å£ï¼‰

### ç¬¬ä¸‰é˜¶æ®µï¼ˆå¢å¼ºåŠŸèƒ½ï¼‰

1. âš ï¸ å®ç°è®¢å•ç®¡ç†ï¼ˆéœ€æ–°å¢åç«¯æ¥å£ï¼‰
2. âš ï¸ å®ç°è¯„ä»·åŠŸèƒ½ï¼ˆå·²æœ‰APIï¼Œéœ€å‰ç«¯å¯¹æ¥ï¼‰
3. âš ï¸ å®ç°æœç´¢ä¼˜åŒ–ï¼ˆå·²æœ‰APIï¼Œéœ€å‰ç«¯ä¼˜åŒ–ï¼‰

---

## å…«ã€é…ç½®è¯´æ˜

### 8.1 åç«¯é…ç½®

åç«¯æœåŠ¡è¿è¡Œåœ¨ï¼š`http://localhost:8080/api`

æ•°æ®åº“é…ç½®ï¼š
```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/bookmarket
    username: root
    password: root
```

### 8.2 å‰ç«¯é…ç½®

åœ¨ `vite.config.js` ä¸­é…ç½®ä»£ç†ï¼š

```javascript
export default defineConfig({
  server: {
    proxy: {
      '/api': {
        target: 'http://localhost:8080',
        changeOrigin: true
      }
    }
  }
})
```

### 8.3 è·¨åŸŸé…ç½®

åç«¯å·²é…ç½®CORSï¼ˆ`CorsConfig.java`ï¼‰ï¼Œå…è®¸å‰ç«¯è·¨åŸŸè®¿é—®ã€‚

---

## ä¹ã€æ³¨æ„äº‹é¡¹

1. **JWT Token**ï¼šç™»å½•åéœ€è¦å°†tokenå­˜å‚¨åœ¨localStorageï¼Œå¹¶åœ¨åç»­è¯·æ±‚çš„Headerä¸­æºå¸¦
2. **å›¾ç‰‡ä¸Šä¼ **ï¼šéœ€è¦å®ç°æ–‡ä»¶ä¸Šä¼ æ¥å£ï¼Œå»ºè®®ä½¿ç”¨OSSæˆ–æœ¬åœ°å­˜å‚¨
3. **åˆ†é¡µå‚æ•°**ï¼šåç«¯é»˜è®¤page=1, pageSize=12ï¼Œå‰ç«¯éœ€ä¿æŒä¸€è‡´
4. **é”™è¯¯å¤„ç†**ï¼šç»Ÿä¸€ä½¿ç”¨Resultæ ¼å¼è¿”å›ï¼Œcode=200è¡¨ç¤ºæˆåŠŸ
5. **æ•°æ®éªŒè¯**ï¼šåç«¯å·²æ·»åŠ å‚æ•°éªŒè¯ï¼Œå‰ç«¯éœ€é…åˆè¿›è¡Œè¡¨å•éªŒè¯

---

## åã€æ€»ç»“

æœ¬æ–‡æ¡£è¯¦ç»†åˆ—å‡ºäº†å‰ç«¯Vue 3é¡¹ç›®ä¸åç«¯Spring Booté¡¹ç›®çš„é€‚é…æ–¹æ¡ˆã€‚åç«¯å·²æä¾›åŸºç¡€çš„ä¹¦ç±ã€åˆ†ç±»ã€è®¤è¯ç›¸å…³APIï¼Œä½†ä»éœ€è¡¥å……ç”¨æˆ·ç®¡ç†ã€è®¢å•ç®¡ç†ã€æ”¶è—ç®¡ç†ç­‰æ¥å£ã€‚å‰ç«¯éœ€è¦å®ç°APIè¯·æ±‚å°è£…ã€çŠ¶æ€ç®¡ç†ã€æ•°æ®æ ¼å¼è½¬æ¢ç­‰åŠŸèƒ½ã€‚

å»ºè®®æŒ‰ç…§å¼€å‘ä¼˜å…ˆçº§é€æ­¥å®ç°åŠŸèƒ½ï¼Œå…ˆå®Œæˆæ ¸å¿ƒçš„ä¹¦ç±æµè§ˆå’Œè¯¦æƒ…å±•ç¤ºï¼Œå†é€æ­¥å®Œå–„ç”¨æˆ·ç›¸å…³åŠŸèƒ½ã€‚
