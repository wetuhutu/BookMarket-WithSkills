# åˆ†ç±»æ˜ å°„é—®é¢˜æœ€ç»ˆä¿®å¤

## é—®é¢˜æ ¹æº

### ç¬¬ä¸€æ¬¡å°è¯•çš„é—®é¢˜

æœ€åˆè®¾ç½®çš„æ˜ å°„è¡¨ä¸åç«¯å®é™…æ•°æ®ä¸åŒ¹é…ï¼š

**é”™è¯¯æ˜ å°„**ï¼š
```javascript
const categoryMap = {
  'æ•™ææ•™è¾…': 'textbook',    // âŒ åç«¯æ²¡æœ‰è¿™ä¸ªåˆ†ç±»
  'æ–‡å­¦å°è¯´': 'novel',       // âœ… å¶ç„¶åŒ¹é…
  'è®¡ç®—æœº': 'computer',      // âŒ åç«¯æ²¡æœ‰è¿™ä¸ªåˆ†ç±»
  'ç»ç®¡': 'business',        // âŒ åç«¯æ²¡æœ‰è¿™ä¸ªåˆ†ç±»
  'å¤–è¯­': 'language',        // âŒ åç«¯æ²¡æœ‰è¿™ä¸ªåˆ†ç±»
  'å…¶ä»–': 'other'            // âŒ åç«¯æ²¡æœ‰è¿™ä¸ªåˆ†ç±»
}
```

**åç«¯å®é™…æ•°æ®**ï¼š
```json
{
  "data": [
    { "name": "æ•™è‚²", "id": "education", "icon": "ğŸ“š", "count": 2 },
    { "name": "è‰ºæœ¯", "id": "art", "icon": "ğŸ¨", "count": 1 },
    { "name": "å†å²", "id": "history", "icon": "ğŸ“œ", "count": 1 },
    { "name": "å°è¯´", "id": "novel", "icon": "ğŸ“–", "count": 1 },
    { "name": "å“²å­¦", "id": "philosophy", "icon": "ğŸ§ ", "count": 1 },
    { "name": "ç§‘å­¦", "id": "science", "icon": "ğŸ”¬", "count": 1 }
  ]
}
```

### ç¬¬äºŒæ¬¡å°è¯•çš„é—®é¢˜

è™½ç„¶æ›´æ–°äº†æ˜ å°„è¡¨ï¼Œä½† `fetchCategories` å‡½æ•°ä½¿ç”¨äº†ä¸å¿…è¦çš„åå‘æ˜ å°„ï¼š

```javascript
const fetchCategories = async () => {
  try {
    const res = await getCategories()
    if (res.code === 200) {
      const reverseMap = {}
      Object.entries(categoryMap).forEach(([cn, en]) => {
        reverseMap[en] = cn
      })
      categories.value = res.data.map(cat => reverseMap[cat.id] || cat.name)
    }
  } catch (error) {
    console.error('è·å–åˆ†ç±»å¤±è´¥:', error)
  }
}
```

**é—®é¢˜**ï¼šåç«¯å·²ç»è¿”å›äº† `name` å­—æ®µï¼ˆä¸­æ–‡ï¼‰ï¼Œä¸éœ€è¦å†è¿›è¡Œåå‘æ˜ å°„ã€‚

## æœ€ç»ˆè§£å†³æ–¹æ¡ˆ

### 1. æ›´æ–°åˆ†ç±»æ˜ å°„è¡¨

```javascript
const categoryMap = {
  'æ•™è‚²': 'education',
  'è‰ºæœ¯': 'art',
  'å†å²': 'history',
  'å°è¯´': 'novel',
  'å“²å­¦': 'philosophy',
  'ç§‘å­¦': 'science'
}
```

### 2. ç®€åŒ– fetchCategories å‡½æ•°

```javascript
const fetchCategories = async () => {
  try {
    const res = await getCategories()
    if (res.code === 200) {
      categories.value = res.data.map(cat => cat.name)
    }
  } catch (error) {
    console.error('è·å–åˆ†ç±»å¤±è´¥:', error)
  }
}
```

**è¯´æ˜**ï¼šç›´æ¥ä½¿ç”¨åç«¯è¿”å›çš„ `name` å­—æ®µï¼ˆä¸­æ–‡ï¼‰ï¼Œæ— éœ€è½¬æ¢ã€‚

### 3. fetchBooks å‡½æ•°ä¿æŒä¸å˜

```javascript
const fetchBooks = async () => {
  try {
    loading.value = true
    const params = {
      page: currentPage.value,
      pageSize: pageSize.value
    }
    
    if (searchQuery.value) {
      params.keyword = searchQuery.value
    }
    if (selectedCategory.value) {
      params.category = categoryMap[selectedCategory.value] || selectedCategory.value
    }
    if (selectedCondition.value) {
      params.condition = selectedCondition.value
    }
    if (sortBy.value !== 'default') {
      params.sortBy = sortBy.value
    }
    
    const res = await getBooks(params)
    if (res.code === 200) {
      books.value = res.data.list
      total.value = res.data.total
    }
  } catch (error) {
    console.error('è·å–ä¹¦ç±åˆ—è¡¨å¤±è´¥:', error)
  } finally {
    loading.value = false
  }
}
```

## å®Œæ•´æµç¨‹

### 1. é¡µé¢åŠ è½½

```
onMounted()
  â†“
fetchCategories()
  â†“
GET /books/categories
  â†“
åç«¯è¿”å›: {name: "æ•™è‚²", id: "education", ...}
  â†“
categories.value = ["æ•™è‚²", "è‰ºæœ¯", "å†å²", "å°è¯´", "å“²å­¦", "ç§‘å­¦"]
  â†“
ä¸‹æ‹‰æ¡†æ˜¾ç¤º: å…¨éƒ¨åˆ†ç±»ã€æ•™è‚²ã€è‰ºæœ¯ã€å†å²ã€å°è¯´ã€å“²å­¦ã€ç§‘å­¦
```

### 2. ç”¨æˆ·é€‰æ‹©åˆ†ç±»

```
ç”¨æˆ·é€‰æ‹©: "å°è¯´"
  â†“
selectedCategory.value = "å°è¯´"
  â†“
handleFilter() â†’ fetchBooks()
  â†“
params.category = categoryMap["å°è¯´"] || "å°è¯´"
  â†“
params.category = "novel"
  â†“
GET /books?category=novel&page=1&pageSize=12
  â†“
åç«¯è¿”å›: categoryId = 'novel' çš„ä¹¦ç±
  â†“
books.value = [...]
```

## æœ€ç»ˆæ˜ å°„å…³ç³»

| å‰ç«¯æ˜¾ç¤º | åç«¯ID | åç«¯nameå­—æ®µ |
|----------|---------|--------------|
| æ•™è‚² | education | æ•™è‚² |
| è‰ºæœ¯ | art | è‰ºæœ¯ |
| å†å² | history | å†å² |
| å°è¯´ | novel | å°è¯´ |
| å“²å­¦ | philosophy | å“²å­¦ |
| ç§‘å­¦ | science | ç§‘å­¦ |

## å…³é”®æ”¹è¿›

### æ”¹è¿›1ï¼šä½¿ç”¨åç«¯å®é™…æ•°æ®

ä¸å†ä½¿ç”¨ç¡¬ç¼–ç çš„åˆ†ç±»é€‰é¡¹ï¼Œè€Œæ˜¯ç›´æ¥ä»åç«¯APIè·å–ã€‚

### æ”¹è¿›2ï¼šç®€åŒ–æ˜ å°„é€»è¾‘

- **fetchCategories**: ç›´æ¥ä½¿ç”¨ `cat.name`ï¼Œæ— éœ€åå‘æ˜ å°„
- **fetchBooks**: ä½¿ç”¨ `categoryMap` è¿›è¡Œä¸­æ–‡â†’è‹±æ–‡è½¬æ¢

### æ”¹è¿›3ï¼šä¿æŒæ•°æ®ä¸€è‡´æ€§

- å‰ç«¯ä¸‹æ‹‰æ¡†æ˜¾ç¤ºï¼šåç«¯è¿”å›çš„ `name` å­—æ®µ
- APIè¯·æ±‚å‚æ•°ï¼šé€šè¿‡ `categoryMap` è½¬æ¢åçš„ `id` å­—æ®µ

## æµ‹è¯•éªŒè¯

### æµ‹è¯•ç”¨ä¾‹1ï¼šé€‰æ‹©"å°è¯´"åˆ†ç±»

1. æ‰“å¼€ http://localhost:5174/books
2. é€‰æ‹©åˆ†ç±»ï¼šå°è¯´
3. æ£€æŸ¥Networkè¯·æ±‚ï¼š
   ```
   GET /books?category=novel&page=1&pageSize=12
   ```
4. ç¡®è®¤è¿”å›çš„ä¹¦ç± `categoryId` ä¸º `novel`

### æµ‹è¯•ç”¨ä¾‹2ï¼šé€‰æ‹©"æ•™è‚²"åˆ†ç±»

1. é€‰æ‹©åˆ†ç±»ï¼šæ•™è‚²
2. æ£€æŸ¥Networkè¯·æ±‚ï¼š
   ```
   GET /books?category=education&page=1&pageSize=12
   ```
3. ç¡®è®¤è¿”å›çš„ä¹¦ç± `categoryId` ä¸º `education`

### æµ‹è¯•ç”¨ä¾‹3ï¼šé€‰æ‹©"å…¨éƒ¨åˆ†ç±»"

1. é€‰æ‹©åˆ†ç±»ï¼šå…¨éƒ¨åˆ†ç±»ï¼ˆç©ºå€¼ï¼‰
2. æ£€æŸ¥Networkè¯·æ±‚ï¼š
   ```
   GET /books?page=1&pageSize=12
   ```
3. ç¡®è®¤è¿”å›æ‰€æœ‰åˆ†ç±»çš„ä¹¦ç±

## ä¿®æ”¹çŠ¶æ€

âœ… å·²å®Œæˆ - åˆ†ç±»æ˜ å°„é—®é¢˜å·²å®Œå…¨ä¿®å¤

## ç›¸å…³æ–‡ä»¶

- `src/views/Books.vue` - æ›´æ–°åˆ†ç±»æ˜ å°„è¡¨å’ŒfetchCategorieså‡½æ•°

## æ€»ç»“

### é—®é¢˜åŸå› 

1. æ˜ å°„è¡¨ä¸åç«¯æ•°æ®ä¸åŒ¹é…
2. fetchCategoriesä½¿ç”¨äº†ä¸å¿…è¦çš„åå‘æ˜ å°„

### è§£å†³æ–¹æ¡ˆ

1. æ›´æ–°æ˜ å°„è¡¨ä¸ºåç«¯å®é™…æ•°æ®
2. ç®€åŒ–fetchCategoriesï¼Œç›´æ¥ä½¿ç”¨åç«¯è¿”å›çš„nameå­—æ®µ

### æ ¸å¿ƒåŸåˆ™

- **æ˜¾ç¤º**ï¼šä½¿ç”¨åç«¯è¿”å›çš„ `name` å­—æ®µï¼ˆä¸­æ–‡ï¼‰
- **æŸ¥è¯¢**ï¼šä½¿ç”¨ `categoryMap` è½¬æ¢åçš„ `id` å­—æ®µï¼ˆè‹±æ–‡ï¼‰
- **ä¿æŒä¸€è‡´**ï¼šå‰ç«¯æ•°æ®å®Œå…¨æ¥è‡ªåç«¯API
